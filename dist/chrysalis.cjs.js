/**
 * Chrysalis v1.0.5-β
 * Casper Søkol, 2019
 * Distributed under the MIT license
 */

Object.defineProperty(exports,"__esModule",{value:!0});var element,oldNode,className="className",CLASS="class",doc=document,NULL=null,EMPTY_OBJ={},FUNCTION="function",RENDER="render",STRING="string",STATE="state",PROPS="p",PARENT_NODE="parentNode",ONCREATE="oncreate",ONDESTROY="ondestroy",ONREMOVE="onremove",ONUPDATE="onupdate",ONINIT="oninit",SHOULDUPDATE="shouldUpdate",FORCEUPDATE="forceUpdate";function i(e,t){for(var n in t)e[n]=t[n];return e}function isNew(e,t){for(var n in e)if(e[n]!==t[n])return!0;for(var n in t)if(e[n]!==t[n])return!0}function isTextNode(e){return typeof e==STRING}function getKey(e){if(e&&(e=e.p))return e.key}function f(e,t,n){n[ONREMOVE]&&n[ONREMOVE](),e.removeChild(t),n[ONDESTROY]&&n[ONDESTROY]()}function clone(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function h(e,t){for(var n,r=[],o=[],a=arguments.length;a-- >2;)r.push(arguments[a]);for(;r.length>0;)if(Array.isArray(n=r.pop()))for(var c=n.length;c-- >0;)r.push(n[c]);else!1===n||!0===n||n==NULL||o.push(n);return t=t||{},typeof e==FUNCTION?(t.c=o,e(t)):{n:e,p:t,c:o}}function eventProxy(e){this.events[e.type](e)}function updateProps(e,t,n,r){for(var o in clone(t,n)){var a=t[o],c=n[o];if("key"==(o=r?o==className?CLASS:o:o==CLASS?className:o));else if("style"==o)if(typeof a==STRING)e[o].cssText=a;else for(var i in typeof c==STRING&&(c=e[o].cssText=""),i(a,c))(a||EMPTY_OBJ)[i]==(c||EMPTY_OBJ)[i]||e[o].setProperty("-"==i[0]&&"-"==i[1]?i:i.replace(/[A-Z]/g,"-$&"),a&&i in a?"number"==typeof a[i]?a[i]+"px":a[i]:"");else"o"==o[0]&&"n"==o[1]?((e.events||(e.events={}))[o=o.slice(2).toLowerCase()]=a)?c||e.addEventListener(o,eventProxy):e.removeEventListener(o,eventProxy):"ref"==o?typeof a==FUNCTION?a(e):a.current=e:"dangerouslySetInnerHTML"==o?e.innerHTML=a.__html:!r&&"list"!=o&&o in e?e[o]=a==NULL?"":a:a==NULL||!1===a?e.removeAttribute(o):e.setAttribute(o,a)}}function createComponent(e,t){e[PROPS]=t;var n=e[RENDER](e[STATE],e[PROPS]);i(e,{setState:function(t,n){typeof t==FUNCTION&&(t=t(e[STATE],e[PROPS]));var r,o,a=clone(e[STATE],t);e[ONUPDATE]&&(r=clone(EMPTY_OBJ,e[STATE]),o=clone(EMPTY_OBJ,e[PROPS])),e[SHOULDUPDATE]?e[SHOULDUPDATE](a,n)&&(e[PROPS]=n,e[STATE]=a,e[FORCEUPDATE](r,o,!0)):(e[PROPS]=n,e[STATE]=a,e[FORCEUPDATE](r,o,!0))},forceUpdate:function(t,n,r){patch(e.$el[PARENT_NODE],e.$el,e.u,e.u=e[RENDER](e[STATE],e[PROPS])),r&&e[ONUPDATE]&&e[ONUPDATE](t,n)},destroy:function(){f(e.$el[PARENT_NODE],e.$el,e)},u:n,$el:createElement(n)})}function createElement(e,t,n){if(""==e.n&&(e=e.c[0]),isTextNode(e))return doc.createTextNode(e);if(e.n[RENDER])return e.n[ONCREATE]&&t.push(e.n[ONCREATE]),e[PROPS].c=e.c,createComponent(e.n,e[PROPS]),e.n[ONINIT]&&e.n[ONINIT](),e.n.$el;var r=(n=n||"svg"==e.n)?doc.createElementNS("http://www.w3.org/2000/svg",e.n):doc.createElement(e.n);updateProps(r,e[PROPS],EMPTY_OBJ,n);for(var o=0,a=e.c.length;o<a;o++)r.appendChild(createElement(e.c[o],t,n));return r}function patch(e,t,n,r,o){var a=[];if(r===n);else if(n!=NULL&&isTextNode(n)&&isTextNode(r)&&n!=r)t.data=r;else if(n==NULL)t=e.insertBefore(createElement(r,a,o),t);else if(r.n[RENDER]){if(isNew(n[PROPS],r[PROPS])){var c,i=n.n;i[ONUPDATE]&&(c=clone(i[PROPS],r[PROPS])),i.setState(EMPTY_OBJ,c)}}else if(r.n&&r.n===n.n){o=o||"svg"==r.n,updateProps(t,n[PROPS],r[PROPS],o);for(var N=r.c.length,s=n.c.length,E={},l=[],P={},T=0;T<s;T++){var O=t.childNodes[T];l[T]=O;var p=n.c[T],u=getKey(p);NULL!=u&&(E[u]=[O,p])}for(var R=0,S=0;S<N;){var v=l[R],d=n.c[R],A=r.c[S],L=getKey(d);if(P[L])R++;else{var U=getKey(A),h=E[U]||[];NULL==U?(NULL==L&&(patch(t,v,d,A,o),S++),R++):(L===U?(patch(t,h[0],h[1],A,o),R++):h[0]?(t.insertBefore(h[0],v),patch(t,h[0],h[1],A,o)):patch(t,v,NULL,A,o),S++,P[U]=A)}}for(;R<s;){var y=n.c[R],D=getKey(y);NULL==D&&f(t,l[R],y),R++}for(var m in E){var g=E[m],C=g[1];P[C.p.key]||f(t,g[0],C)}}else if(r!==n){var x=t;e.replaceChild(t=createElement(r,a,o),x)}for(;a.length;)a.pop()();return t}function render(e,t,n){element=patch(t,element,oldNode,oldNode=e),n&&n()}function createRef(){return{}}exports.h=h,exports.render=render,exports.createRef=createRef;
