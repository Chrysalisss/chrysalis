/**
 * Chrysalis v1.0.6-β
 * Casper Søkol, 2019
 * Distributed under the MIT license
 */

Object.defineProperty(exports,"__esModule",{value:!0});var element,oldNode,doc=document,NULL=null,EMPTY_OBJ={},FUNCTION="function",RENDER="render",STRING="string",STATE="state",PROPS="props",PARENT_NODE="parentNode",LENGTH="length",CHILDREN="children",isArray=Array.isArray,ONCREATE="oncreate",ONDESTROY="ondestroy",ONREMOVE="onremove",ONUPDATE="onupdate",ONINIT="oninit",SHOULDUPDATE="shouldUpdate",FORCEUPDATE="forceUpdate";function i(e,t){for(var r in t)e[r]=t[r];return e}function isNew(e,t){for(var r in e)if(e[r]!==t[r])return!0;for(var r in t)if(e[r]!==t[r])return!0}function isTextNode(e){return"object"!=typeof e}function getKey(e){if(e&&(e=e[PROPS]))return e.key}function f(e,t,r){r[ONREMOVE]&&r[ONREMOVE](),e.removeChild(t),r[ONDESTROY]&&r[ONDESTROY]()}function clone(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r}function h(e,t){for(var r,n=[],o=[],E=arguments,a=E[LENGTH];a-- >2;)n.push(E[a]);for(;n[LENGTH]>0;)if(isArray(r=n.pop()))for(var i=r[LENGTH];i-- >0;)n.push(r[i]);else!1===r||!0===r||r==NULL||o.push(r);return t=t||EMPTY_OBJ,typeof e==FUNCTION?(t[CHILDREN]=o,e(t)):{n:e,props:t,t:o}}function eventProxy(e){this.events[e.type](e)}function updateProps(e,t,r,n){for(var o in clone(t,r)){var E=t[o],a=r[o];if("key"==o||o==CHILDREN);else if("style"==o)if(typeof value==STRING)e[o].cssText=E;else for(var i in typeof a==STRING&&(a=e[o].cssText=""),i(E,a))(E||EMPTY_OBJ)[i]==(a||EMPTY_OBJ)[i]||e[o].setProperty("-"==i[0]&&"-"==i[1]?i:i.replace(/[A-Z]/g,"-$&"),E&&i in E?"number"==typeof E[i]?E[i]+"px":E[i]:"");else"o"==o[0]&&"n"==o[1]?((e.events||(e.events={}))[o=o.substr(2).toLowerCase()]=E)?a||e.addEventListener(o,eventProxy):e.removeEventListener(o,eventProxy):"ref"==o?typeof E==FUNCTION?E(e):E.current=e:"dangerouslySetInnerHTML"==o?e.innerHTML=E.__html:!n&&"list"!=o&&o in e?e[o]=E==NULL?"":E:E==NULL||!1===E?e.removeAttribute(o):e.setAttribute(o,E)}}function createComponent(e,t){e[PROPS]=t;var r=e[RENDER](e[STATE],e[PROPS]);i(e,{setState:function(t,r){typeof t==FUNCTION&&(t=t(e[STATE],e[PROPS]));var n,o,E=clone(e[STATE],t);e[ONUPDATE]&&(n=clone(EMPTY_OBJ,e[STATE]),o=clone(EMPTY_OBJ,e[PROPS])),e[SHOULDUPDATE]?e[SHOULDUPDATE](E,r)&&(e[PROPS]=r,e[STATE]=E,e[FORCEUPDATE](n,o,!0)):(e[PROPS]=r,e[STATE]=E,e[FORCEUPDATE](n,o,!0))},forceUpdate:function(t,r,n){patch(e.$el[PARENT_NODE],e.$el,e.u,e.u=e[RENDER](e[STATE],e[PROPS])),n&&e[ONUPDATE]&&e[ONUPDATE](t,r)},destroy:function(){f(e.$el[PARENT_NODE],e.$el,e)},u:r,$el:createElement(r)})}function createElement(e,t,r){function n(e,n){for(var o=0,E=n[LENGTH];o<E;o++)e.appendChild(createElement(n[o],t,r))}if(isArray(e)){var o=createElement(e[0]);return n(o,e),o}if(isTextNode(e))return doc.createTextNode(e);var E=e.n;if(E[RENDER])return E[ONCREATE]&&t.push(E[ONCREATE].bind(E)),!E.t&&(E[PROPS][CHILDREN]=e.t),createComponent(E,e[PROPS]),E[ONINIT]&&E[ONINIT](),E.$el;var a=(r=r||"svg"==E)?doc.createElementNS("http://www.w3.org/2000/svg",E):doc.createElement(E);return e[PROPS]&&updateProps(a,e[PROPS],EMPTY_OBJ,r),n(a,e.t),a}function patch(e,t,r,n,o){var E=[];if(n===r);else if(r!=NULL&&isTextNode(r)&&isTextNode(n)&&r!=n)t.data=n;else if(r==NULL)t=e.insertBefore(createElement(n,E,o),t);else if(n.n[RENDER]){if(isNew(r[PROPS],n[PROPS])){var a,i=r.n;i[ONUPDATE]&&(a=clone(i[PROPS],n[PROPS])),i.setState(EMPTY_OBJ,a)}}else if(n.n&&n.n===r.n){o=o||"svg"==n.n,updateProps(t,r[PROPS],n[PROPS],o);for(var N=n.t[LENGTH],T=r.t[LENGTH],P={},s=[],O={},c=0;c<T;c++){var u=t.t[c];s[c]=u;var R=r.t[c],l=getKey(R);NULL!=l&&(P[l]=[u,R])}for(var p=0,v=0;v<N;){var d=s[p],L=r.t[p],S=n.t[v],A=getKey(L);if(O[A])p++;else{var U=getKey(S),y=P[U]||[];NULL==U?(NULL==A&&(patch(t,d,L,S,o),v++),p++):(A===U?(patch(t,y[0],y[1],S,o),p++):y[0]?(t.insertBefore(y[0],d),patch(t,y[0],y[1],S,o)):patch(t,d,NULL,S,o),v++,O[U]=S)}}for(;p<T;){var D=r.t[p],h=getKey(D);NULL==h&&f(t,s[p],D),p++}for(var m in P){var C=P[m],I=C[1];O[I[PROPS].key]||f(t,C[0],I)}}else if(n!==r){var H=t;e.replaceChild(t=createElement(n,E,o),H)}for(;E[LENGTH];)E.pop()();return t}function render(e,t,r){element=patch(t,element,oldNode,oldNode=e),r&&r()}function createRef(){return{}}function Fragment(e){return e.children}exports.h=h,exports.render=render,exports.createRef=createRef,exports.Fragment=Fragment;
